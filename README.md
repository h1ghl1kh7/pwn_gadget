# pwn_gadget
Find satisfiable one gadgets from the state of a running gdb instance

# How does this work?
pwn_gadget parses the constraints generated by [one_gadget](https://github.com/david942j/one_gadget) in python into a format that can be evaluated by a gdb `print` command.

Leveraging the Gdb python api, accessed through pwntools' gdb module to it executes those commands parsed from the one_gadget constraints.

Performs all of the boolean operations in the one_gadget constraints on the results from the commands run in gdb.

Searches for a gadget where every boolean operation returned True, returning either that offset or None.

If a satisfiable gadget is not found, information on the gadget with the least failed conditions will be printed.

# Usage

```python
from pwn import *
import pwn_gadget

p = process("chal", aslr=False)
libc = p.libc

# break at the target address
gdbscript = """
b *0x555555558050
c
"""
_, gdb_api = gdb.attach(p, gdbscript=gdbscript, api=True)
one_gadget = pwn_gadget.find(gdb_api, libc.path)
if one_gadget is None:
  exit()

rop_payload = b"A"*32 + p64(one_gadget+libc.address)
p.interactive()
```

# Example Output
## Success
```
[+] Waiting for debugger: Done
[+] Finding one gadgets
[+] Found 15 one gadgets
[+] Performing gdb operations to evaluate constraints
[+] Found satisfiable one gadget at offset 0x10dbd9
```
## Failure
```
[+] Finding one gadgets
[+] Found 15 one gadgets
[+] Performing gdb operations to evaluate constraints
No immediately satisfiable one gadgets found
Best gadget found at offset 0x50a37, with 1 failed constraints
Constraints Failed:
rsp & 0xf == 0
[+] Failed to find satisfiable one gadget, returning None
```
